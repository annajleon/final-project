---
title: "STAT 184 Final Project"
subtitle: "NYC AirBnb Data"
author: "Anna Leon"
output: html_notebook
---

## Front Matter

```{r}
# clean up workspace environment
rm(list = ls())

# all packages used for the assignment
library(DataComputing)
library(readr)
library(dplyr)
```

## Data Access

### Reading in Data
```{r}
NYC <- read_csv("AB_NYC_2019.csv")
```

### Exploring our Data

```{r}
head(NYC)
```

```{r}
names(NYC)
```

```{r}
glimpse(NYC) 
```

## Data Wrangling

I am dropping variables id, host_name, last_review, and minimum_nights because they are not relevant to my analysis.
```{r}
NewNYC <-
  NYC %>%
    select(name, host_id, neighbourhood, neighbourhood_group, latitude, longitude, room_type, price, number_of_reviews, reviews_per_month, calculated_host_listings_count, availability_365)
NewNYC
```

### Top NYC Airbnb Hosts

```{r}
HostListingsCount <-
  NewNYC %>%
    group_by(host_id) %>%
    summarise(listings = n()) %>%
    arrange(desc(listings))
HostListingsCount
```

Now, host 219517861 has the most listings in NYC, 327. So, where are his listings?
We can find out that they are all in Manhattan.

```{r}
NewNYC %>%
  filter(host_id == 219517861) %>%
  group_by(neighbourhood_group) %>%
  summarise(count = n())
```

### Price Comparison between Boroughs

```{r}
BoroughAvgPrice <-
  NewNYC %>%
    group_by(borough = neighbourhood_group) %>%
    summarise(avg_price = round(mean(price, na.rm=TRUE))) %>%
    arrange(desc(avg_price))
BoroughAvgPrice
```

```{r}
NYCwAvg <-
  NewNYC %>%
    left_join(BoroughAvgPrice, by = c("neighbourhood_group" = "borough")) %>%
    rename(avg_price_in_borough = avg_price)
NYCwAvg
```

### Price Comparison between Neighborhoods

```{r}
NeighborhoodAvgPrice <-
  NewNYC %>%
    group_by(neighbourhood) %>%
    summarise(avg_price = round(mean(price, na.rm=TRUE))) %>%
    arrange(desc(avg_price))

HoodinBorough <-
  NewNYC %>%
    group_by(neighbourhood_group, neighbourhood) %>%
    summarise(count = n())

NeighborhoodsInfo <-
  NeighborhoodAvgPrice %>%
    left_join(HoodinBorough)

NeighborhoodsInfo
```

### "Cozy" Airbnbs

Now, I will be investigating the difference between price and availability of airbnbs that do not have the word cozy in their title with those that do. It turns out that airbnbs that are described as cozy typically cost less than their counterparts; however, their availability is lower as well. 

```{r}
CozyAirbnbs <-
  NewNYC %>%
    filter(grepl("cozy", name, ignore.case = TRUE))

NotCozyAirbnbs <-
  NewNYC %>%
    filter(!grepl("cozy", name, ignore.case = TRUE))

CozyAirbnbs
NotCozyAirbnbs

CozyAirbnbs %>%
  summarise(ave_cost = round(mean(price, na.rm = TRUE), 2))

NotCozyAirbnbs %>%
  summarise(ave_cost = round(mean(price, na.rm = TRUE), 2))

CozyAirbnbs %>%
  summarise(ave_availability = round(mean(availability_365, na.rm = TRUE)))

NotCozyAirbnbs %>%
  summarise(ave_availability = round(mean(availability_365, na.rm = TRUE)))
```


## Data Visualization

### Most Expensive Neighborhoods

```{r}
NeighborhoodsInfo$neighbourhood <- factor(NeighborhoodsInfo$neighbourhood,levels = c("Fort Wadsworth", "Woodrow", "Tribeca", "Sea Gate", "Riverdale"))

NeighborhoodsInfo %>%
  head(5) %>%
  ggplot(aes(x=neighbourhood, y=avg_price)) + 
  geom_point(aes(size=count)) +
  ggtitle("5 Most Expensive Neighborhoods for Airbnbs")
```

### Listing Boroughs for Top Hosts

As we can see here, nine out of the top ten hosts with the most Airbnb listings in NYC had the highest number of listings in Manhattan out of the five boroughs.
```{r}
TopHosts <-
  HostListingsCount %>%
    head(10)
TopHosts$top_borough = NA

for(i in 1:10){
  Ranked <-
      NewNYC %>%
        filter(host_id == TopHosts$host_id[i]) %>%
        group_by(neighbourhood_group) %>%
        summarise(count = n()) %>%
        mutate(rank = rank(count)) %>%
        arrange(desc(rank)) 
    TopHosts$top_borough[i] <- toString(Ranked[1,1])
}
TopHosts
```

### Favorite borough of top ten hosts visualization 

```{r}
slices <- c(9,1)
pie(slices, labels = c("Manhattan, Queens"), main="Favorite Boroughs of Top Hosts")
```

